<nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center gap-2 fw-semibold text-dark" href="/">
      <i class="bi bi-chat-dots text-primary"></i>
      <span>Forum</span>
    </a>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#nav"
      aria-controls="nav"
      aria-expanded="false"
      aria-label="Navigation umschalten"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" href="/categories">
            <i class="bi bi-grid"></i> Kategorien
          </a>
        </li>

        <% if (currentUser) { %>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="supportDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-life-preserver"></i> Support
          </a>
          <ul class="dropdown-menu" aria-labelledby="supportDropdown">
            <li>
              <a class="dropdown-item" href="/tickets">
                Meine Tickets
              </a>
            </li>
            <li>
              <a class="dropdown-item" href="/tickets/new">
                Neues Ticket
              </a>
            </li>
            <% if (realUser?.is_admin) { %>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a class="dropdown-item" href="/admin/tickets">
                Admin-Ticketboard
              </a>
            </li>
            <% } %>
          </ul>
        </li>
        <% } %>

        <% if (realUser?.is_admin) { %>
          <li class="nav-item">
            <a class="nav-link" href="/admin/categories">
              <i class="bi bi-sliders"></i> Admin
            </a>
          </li>
        <% } %>
      </ul>

      <ul class="navbar-nav align-items-center">
        <% if (currentUser) { %>
          <li class="nav-item me-2 small text-muted">
            Hallo,
            <strong class="text-dark"><%= currentUser.name %></strong>
          </li>

          <% if (realUser?.is_admin) { %>
            <li class="nav-item me-2 small text-muted d-flex align-items-center">
              <span class="me-1">Ansicht:</span>
              <% if (viewAsUser) { %>
                <span class="badge bg-secondary">User</span>
              <% } else { %>
                <span class="badge bg-primary">Admin</span>
              <% } %>
            </li>

            <li class="nav-item me-2">
              <form method="post" action="/admin/view-mode" class="d-inline js-view-mode-form">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <input type="hidden" name="mode" value="<%= viewAsUser ? 'admin' : 'user' %>">
                <input type="hidden" name="returnTo" value="<%= currentPath %>">
                <button class="btn btn-outline-secondary btn-sm" type="submit">
                  <%= viewAsUser ? 'Als Admin anzeigen' : 'Als User anzeigen' %>
                </button>
              </form>
            </li>
          <% } %>

          <li class="nav-item">
            <form method="post" action="/logout" class="d-inline">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>">
              <button class="btn btn-outline-secondary btn-sm" type="submit">
                <i class="bi bi-box-arrow-right"></i> Logout
              </button>
            </form>
          </li>
        <% } else { %>
          <li class="nav-item">
            <a class="btn btn-outline-secondary btn-sm me-2" href="/login">
              Login
            </a>
          </li>
          <li class="nav-item">
            <a class="btn btn-primary btn-sm" href="/register">
              Registrieren
            </a>
          </li>
        <% } %>
      </ul>
    </div>
  </div>
</nav>

